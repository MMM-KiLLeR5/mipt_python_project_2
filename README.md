## Описание проекта
Мы создаем телеграм-бота для изучения новых языков с использованием web-скрапинга для получения материалов, таких как новые слова, выражения и образцы разговоров. Бот также будет поддерживать вэб-хуки, локализацию, обертку в Docker и деплой на отдельный сервер для удобства использования.

## Реализуемый функционал
1. Предоставление ежедневных уроков по изучаемому языку на основе собранных материалов с веб-сайтов.
2. Отправка новых слов и выражений для изучения пользователям.
3. Проведение викторин для проверки знаний.
4. Практика разговорных навыков через чат-бота.
5. Поддержка вэб-хуков для получения уведомлений о новых уроках и викторинах.
6. Локализация интерфейса бота для поддержки различных языков.
7. Обертка приложения в Docker для упрощения развертывания.

## Архитектура
1. **BotController (контроллер бота):**
   - Метод `start()` для инициализации бота и начала обработки сообщений.
   - Метод `handle_message()` для обработки входящих сообщений от пользователей.
   
2. **LessonManager (менеджер уроков):**
   - Метод `get_daily_lesson()` для получения ежедневного урока с помощью веб-скрапинга.
   - Метод `send_lesson()` для отправки урока пользователю.
   
3. **QuizManager (менеджер викторин):**
   - Метод `generate_quiz()` для генерации викторины на основе изучаемого материала.
   - Метод `check_answer()` для проверки ответа пользователя на вопрос викторины.

4. **LanguageLearning (изучение языков):**
   - Метод `learn_new_words()` для получения новых слов и выражений для изучения с помощью веб-скрапинга.
   - Метод `practice_conversation()` для практики разговорных навыков.

5. **WebhookManager (менеджер вэб-хуков):**
   - Методы для регистрации, обновления и удаления вэб-хуков.
   
6. **LocalizationManager (менеджер локализации):**
   - Методы для загрузки и установки языковых файлов интерфейса бота.

7. **DockerWrapper (обертка в Docker):**
   - Методы для создания Docker-контейнера и его запуска.

8. **Main (основной модуль):**
   - Инициализация и запуск контроллера бота.

### Запуск через докер контейнер
    docker build -t telegram_bot .
    touch .env(внутри неё, сооздадите переменные окружение BOT_TOKEN - токен бота, ADMINS_ID - ID чата службы поддержки, ADMINS - админы)
### Тоже два спопоба запуска
    docker run --env-file=.env --name telegram_bot_service telegram_bot
    docker run -e BOT_TOKEN=[токен бота] ADMINS_ID=[ID чата службы поддержки] ADMINS=[api]

# Телеграмм бот, находящий информацию по похожим вопросам.
> У поступающих в МФТИ есть множество вопросов, которые разбросаны по множествам источников. Было бы удобно собрать информацию в одном месте, а также легко с нем оперировать. В качестве помощника может выступать данный телеграмм-бот, который по заданному сообщению выдает родственные запросы.

## Подготовка к использованию

Для использования необходимы python3, а также библиотеки aiogram, pymystem3.
Клонируйте репозиторий, а после введите:

```shell
pip install requirement.txt
```

Далее необходимо настроить файл `config.py`.

1. Получите токен бота у BotFather: [обучающая статья](#https://botcreators.ru/blog/botfather-instrukciya/) и вставьте его в `config.py::BOT_TOKEN`.
2. Заполните соотвествующие id, где  
    - `config.py::support_ids` - люди, получающие уведомления о ключевых операциях с ботом.
    - `config.py::ADMINS` - люди, отвечающие на запросы.
    - `config.py::admin_id` - главный админ.


После достаточно запустить 
```shell
python3 ./src/main.py
```
## Функционал

### Краткое описание

Для пользователя присутствует 2 режима:
 - Найти запрос среди уже присутствующих в базе данных
 - Начать диалог с одним из админов, который выбирается произвольным образом. 

### Комманды
Для пользователя:
- `/find` - Найти похожий вопрос
- `/support` - Написать сообщение (одно) модератору
- `/support_call` - Пообщаться с модератором (переписка)

Для админов:
- `/new_quest` - Добавить новый вопрос в базу данных.


## Особенности реализации

### Анализ сообщения
Лексический анализ сообщения происходит на основе системы [mystem](#https://nlpub.ru/Mystem), далее происходит сравнение по ключевых словам в базе данным и поступившем запросе.

### Хранение вопросов
При добавлении нового вопроса используется парсинг сайта с синонимами https://sin.slovaronline.com/search. Стоит помнить, что разбор запросы актуален на 2022 год, поэтому в случае возникновения ошибок либо стоит отключить данный модуль (см. файл `new_quest.py`), либо проанализировать тело результата самостоятельно.

База данных представляет из себя:
 - вопрос - `question`
 - ответ - `answer`
 - изображение к ответу - `photo`

*Замечание:* в момент создание автор плохо ориентировался в sql, поэтому база данных не соответсвует даже первой нормальной форме. Если вы хотите использовать данную реализацию, то необходимо добавить еще одну связующую таблицу, которая уберет связь многие к многим.

